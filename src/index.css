@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═════════════════════════════════════════════════════════════════════════════════
   TRIBES MARKETING SITE — LOCKED DESIGN TOKENS (DO NOT TOUCH)
   
   Source of truth for spacing + typography.
   
   RULES:
   1) Use ONLY these tokens for spacing (no ad-hoc px/rem).
   2) No custom margins/paddings on pages/components.
   3) Section padding MUST use section* tokens.
   4) Stacks MUST use stack* tokens.
   5) Divider blocks MUST use dividerSpacing* tokens.
   6) Typography MUST use the locked type scale.
   
   Any deviation requires explicit approval and cross-page verification.
   ═════════════════════════════════════════════════════════════════════════════════ */

:root {
  /* ═══════════════════════════════════════════════════════════════════════════════
     SPACING SCALE — LOCKED (Use only these. No arbitrary values.)
     ═══════════════════════════════════════════════════════════════════════════════ */
  --space-1: 0.25rem;   /* 4px  */
  --space-2: 0.5rem;    /* 8px  */
  --space-3: 0.75rem;   /* 12px */
  --space-4: 1rem;      /* 16px */
  --space-5: 1.25rem;   /* 20px */
  --space-6: 1.5rem;    /* 24px */
  --space-7: 2rem;      /* 32px */
  --space-8: 2.5rem;    /* 40px */
  --space-9: 3rem;      /* 48px */
  --space-10: 4rem;     /* 64px */
  --space-11: 5rem;     /* 80px */
  --space-12: 6rem;     /* 96px */

  /* ═══════════════════════════════════════════════════════════════════════════════
     SECTION PADDING — MOBILE (Default)
     
     Light sections slightly larger than dark for perceived parity.
     ═══════════════════════════════════════════════════════════════════════════════ */
  --sectionDarkMobileY: var(--space-10);    /* 64px */
  --sectionLightMobileY: 4.5rem;            /* 72px */
  --footerMobileTop: var(--space-11);       /* 80px */
  --footerMobileBottom: 3.5rem;             /* 56px */
  
  /* Active section tokens (used by utility classes) */
  --section-padding-y-dark: var(--sectionDarkMobileY);
  --section-padding-y-light: var(--sectionLightMobileY);
  --section-padding-y: var(--section-padding-y-light);
  --footer-padding-top: var(--footerMobileTop);
  --footer-padding-bottom: var(--footerMobileBottom);

  /* ═══════════════════════════════════════════════════════════════════════════════
     CONTAINER — Horizontal gutters and max width
     ═══════════════════════════════════════════════════════════════════════════════ */
  --containerPaddingMobile: var(--space-5);  /* 20px */
  --containerPaddingDesktop: var(--space-8); /* 40px */
  --maxContentWidth: 45rem;                  /* 720px */
  --gutter: var(--containerPaddingMobile);

  /* ═══════════════════════════════════════════════════════════════════════════════
     STACK SPACING — Content Block Rhythm (Mobile)
     
     stackTight:  Tight coupling (list items, tight metadata)
     stackSmall:  List items, metadata, helper text
     stackMedium: Headings to paragraphs, paragraph to paragraph  
     stackLarge:  Section title to body, major content blocks
     ═══════════════════════════════════════════════════════════════════════════════ */
  --stackTightMobile: var(--space-2);   /* 8px */
  --stackSmallMobile: var(--space-3);   /* 12px */
  --stackMediumMobile: var(--space-5);  /* 20px */
  --stackLargeMobile: var(--space-7);   /* 32px */
  
  /* Active stack tokens */
  --stack-tight: var(--stackTightMobile);
  --stack-small: var(--stackSmallMobile);
  --stack-standard: var(--stackMediumMobile);
  --stack-loose: var(--stackLargeMobile);

  /* ═══════════════════════════════════════════════════════════════════════════════
     DIVIDER SPACING — Horizontal rules (Mobile)
     ═══════════════════════════════════════════════════════════════════════════════ */
  --dividerSpacingMobile: var(--space-6);  /* 24px */
  --divider-spacing: var(--dividerSpacingMobile);

  /* ═══════════════════════════════════════════════════════════════════════════════
     LEDE → LIST/STEPS BRIDGE — Locked transition pattern
     ═══════════════════════════════════════════════════════════════════════════════ */
  --lede-to-list-mobile: var(--space-5);   /* 20px */
  --lede-to-list-desktop: var(--space-6);  /* 24px */
  --list-item-stack-mobile: var(--space-5); /* 20px */
  --list-item-stack-desktop: var(--space-6); /* 24px */

  /* ═══════════════════════════════════════════════════════════════════════════════
     SECTION HEADER RHYTHM — Eyebrow + headline pattern
     ═══════════════════════════════════════════════════════════════════════════════ */
  --eyebrow-bottom: var(--stackMediumMobile);   /* 20px */
  --headline-bottom: var(--stackMediumMobile);  /* 20px */

  /* ═══════════════════════════════════════════════════════════════════════════════
     TYPOGRAPHY SCALE — MOBILE (Default)
     ═══════════════════════════════════════════════════════════════════════════════ */
  --labelCapsSize: 0.75rem;           /* 12px */
  --labelCapsWeight: 500;
  --labelCapsTracking: 0.12em;
  --labelCapsLine: 1rem;              /* 16px */

  --h1Size: 2.75rem;                  /* 44px */
  --h1Weight: 600;
  --h1Line: 3rem;                     /* 48px */

  --h2Size: 1.75rem;                  /* 28px */
  --h2Weight: 600;
  --h2Line: 2.125rem;                 /* 34px */

  --h3Size: 1.125rem;                 /* 18px */
  --h3Weight: 600;
  --h3Line: 1.5rem;                   /* 24px */

  --bodySize: 1rem;                   /* 16px */
  --bodyWeight: 400;
  --bodyLine: 1.625rem;               /* 26px */

  --smallSize: 0.875rem;              /* 14px */
  --smallWeight: 400;
  --smallLine: 1.375rem;              /* 22px */

  /* ═══════════════════════════════════════════════════════════════════════════════
     INTERACTION TOKENS — Focus, tap, motion
     ═══════════════════════════════════════════════════════════════════════════════ */
  --brandFocus: #0071E3;              /* use only for focus/active states */
  --focusRingWidth: 2px;
  --focusRingOffset: 2px;
  --tapOpacity: 0.78;                 /* press state */
  --motionFast: 200ms;
  --motionEase: cubic-bezier(0.2, 0.8, 0.2, 1);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   DESKTOP OVERRIDES (1024px+)
   ═══════════════════════════════════════════════════════════════════════════════ */
@media (min-width: 1024px) {
  :root {
    /* Section spacing — desktop */
    --sectionDarkDesktopY: var(--space-12);     /* 96px */
    --sectionLightDesktopY: 6.5rem;             /* 104px */
    --footerDesktopTop: 7rem;                   /* 112px */
    --footerDesktopBottom: var(--space-11);     /* 80px */
    
    /* Active section tokens */
    --section-padding-y-dark: var(--sectionDarkDesktopY);
    --section-padding-y-light: var(--sectionLightDesktopY);
    --section-padding-y: var(--section-padding-y-light);
    --footer-padding-top: var(--footerDesktopTop);
    --footer-padding-bottom: var(--footerDesktopBottom);

    /* Stack spacing — desktop */
    --stackTightDesktop: 0.625rem;    /* 10px */
    --stackSmallDesktop: var(--space-4);   /* 16px */
    --stackMediumDesktop: var(--space-6);  /* 24px */
    --stackLargeDesktop: var(--space-8);   /* 40px */
    
    --stack-tight: var(--stackTightDesktop);
    --stack-small: var(--stackSmallDesktop);
    --stack-standard: var(--stackMediumDesktop);
    --stack-loose: var(--stackLargeDesktop);

    /* Divider spacing — desktop */
    --dividerSpacingDesktop: var(--space-7);  /* 32px */
    --divider-spacing: var(--dividerSpacingDesktop);

    /* Container — desktop */
    --gutter: var(--containerPaddingDesktop);

    /* Eyebrow/headline rhythm — desktop */
    --eyebrow-bottom: var(--stackMediumDesktop);
    --headline-bottom: var(--stackMediumDesktop);
    
    /* Lede to list — desktop */
    --lede-to-list: var(--lede-to-list-desktop);
    --list-item-stack: var(--list-item-stack-desktop);

    /* Typography — desktop */
    --h1Size: 4rem;                   /* 64px */
    --h1Line: 4.5rem;                 /* 72px */
    --h2Size: 2.25rem;                /* 36px */
    --h2Line: 2.75rem;                /* 44px */
    --h3Size: 1.25rem;                /* 20px */
    --h3Line: 1.75rem;                /* 28px */
    --bodySize: 1.125rem;             /* 18px */
    --bodyLine: 1.875rem;             /* 30px */
    --smallSize: 0.9375rem;           /* 15px */
    --smallLine: 1.5rem;              /* 24px */
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL COLOR CONTRAST SYSTEM — LOCKED

   This color system is authoritative and must not drift.
   All text must pass WCAG AA contrast minimums.

   LIGHT MODE (default):
   - Primary text: foreground (HSL 0 0% 9%) — near-black
   - Secondary text: muted-foreground (HSL 0 0% 45%) — readable gray
   - Background: background (HSL 0 0% 100%) — white

   DARK SECTIONS (#111214):
   - Primary text: white/92 — Headlines, critical copy
   - Secondary text: white/70-72 — Descriptions, body copy
   - Tertiary text: white/55-65 — Labels, meta, supporting copy
   - Meta/Footer text: white/50-60 — Copyright, legal links
   - Links: white/60 default → white/80 hover
   - Dividers: white/15

   PROHIBITIONS:
   - No text below white/50 on dark backgrounds
   - No arbitrary gray values — use semantic tokens
   - No opacity-based text that reduces readability
   ═══════════════════════════════════════════════════════════════════════════════ */

/* Apple-grade Design System
   System typography, spacing-led layout, minimal dividers, calm hierarchy */

@layer base {
  :root {
    /* Header height for content clearance calculations */
    --header-height: 64px;
    /* Mobile-aware header height variable used by hero sections */
    --header-h: 56px; /* Mobile: 56px (h-14) */

    /* Site black (LOCKED) — used as the global baseline behind all pages */
    --site-black: 210 21% 5%;

    /* Background & Surface */
    --background: 0 0% 100%;
    --foreground: 0 0% 9%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 9%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 9%;

    /* Primary - Neutral dark */
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 100%;

    /* Secondary - Soft gray */
    --secondary: 0 0% 96%;
    --secondary-foreground: 0 0% 9%;

    /* Muted */
    --muted: 0 0% 96%;
    --muted-foreground: 0 0% 45%;

    /* Accent */
    --accent: 0 0% 96%;
    --accent-foreground: 0 0% 9%;

    /* Destructive */
    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    /* Borders & Inputs */
    --border: 0 0% 90%;
    --input: 0 0% 90%;
    --ring: 0 0% 9%;

    --radius: 10px;

    /* Tribes consent checkbox tokens (LOCKED) */
    --tribes-checkbox-border: 0 0% 81%; /* ~#cfcfcf */
    --tribes-checkbox-border-checked: 0 0% 53%; /* ~#888 */
    --tribes-checkbox-check: 0 0% 7%; /* ~#111 */
    --tribes-checkbox-focus: 0 0% 7% / 0.25;

    /* Sidebar */
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 0 0% 45%;
    --sidebar-primary: 0 0% 9%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 0 0% 94%;
    --sidebar-accent-foreground: 0 0% 9%;
    --sidebar-border: 0 0% 90%;
    --sidebar-ring: 0 0% 9%;

    /* Semantic */
    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 9%;
    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;
  }

  .dark {
    /* Near-black backgrounds - #0E0F12 primary, #13141A secondary */
    --background: 228 10% 6%;
    --foreground: 220 10% 97%;

    /* Cards use secondary dark */
    --card: 228 10% 9%;
    --card-foreground: 220 10% 97%;

    --popover: 228 10% 9%;
    --popover-foreground: 220 10% 97%;

    /* Primary inverts for dark */
    --primary: 220 10% 97%;
    --primary-foreground: 228 10% 6%;

    /* Secondary surfaces */
    --secondary: 228 10% 12%;
    --secondary-foreground: 220 10% 97%;

    /* Muted - reduced opacity text */
    --muted: 228 10% 12%;
    --muted-foreground: 220 5% 60%;

    /* Accent */
    --accent: 228 10% 12%;
    --accent-foreground: 220 10% 97%;

    --destructive: 0 62% 45%;
    --destructive-foreground: 220 10% 97%;

    /* Thin dividers - rgba(255,255,255,0.08) equivalent */
    --border: 0 0% 100% / 0.08;
    --input: 228 10% 15%;
    --ring: 220 10% 80%;

    --sidebar-background: 228 10% 6%;
    --sidebar-foreground: 220 5% 60%;
    --sidebar-primary: 220 10% 97%;
    --sidebar-primary-foreground: 228 10% 6%;
    --sidebar-accent: 228 10% 12%;
    --sidebar-accent-foreground: 220 10% 97%;
    --sidebar-border: 0 0% 100% / 0.08;
    --sidebar-ring: 220 10% 80%;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL TYPOGRAPHY SCALE — LOCKED

   This typography system is authoritative and must not drift.
   No page-specific overrides. Mercury/JPMorgan reference standard.

   H1: 32px (mobile) / 40px (desktop), Semibold, -0.015em tracking
   H2: 20px globally, Medium weight, subordinate to H1
   Body: 16px, Regular, 1.65 line-height for long-form reading
   Meta: 13px for helper text, labels

   SPACING:
   - H1 margin-bottom: 12px (tight coupling to intro)
   - H2 margin-bottom: 16px
   - Paragraph gap: 1rem (not stacked whitespace)
   ═══════════════════════════════════════════════════════════════════════════════ */
@layer base {
  * {
    @apply border-border;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL VIEWPORT + iOS SAFARI FIX — PREVENTS WHITE FALL-THROUGH

     CRITICAL: html/body background is DARK by default to prevent white bleed
     on iOS Safari during bounce, dynamic viewport changes, and safe-area reveal.

     Light pages explicitly paint their own white background via layout wrappers.
     ═══════════════════════════════════════════════════════════════════════════ */
  html {
    /* Site black baseline - prevents iOS white flash */
    background-color: hsl(210 21% 5%) !important;
    background-color: hsl(var(--site-black)) !important;
    margin: 0;
    padding: 0;
    min-height: 100%;
    /* DO NOT use scroll-behavior: smooth globally — causes jank on iOS */
    /* Prevent bounce revealing light browser canvas */
    overscroll-behavior-y: none;
  }

  body {
    /* Site black baseline for iOS Safari */
    background-color: hsl(210 21% 5%) !important;
    background-color: hsl(var(--site-black)) !important;
    color: hsl(var(--foreground));
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    /* Mobile: slightly smaller body copy (~5% reduction) with more breathing room */
    font-size: 15px;
    line-height: 1.72;
    margin: 0;
    padding: 0;
    /* Prevent horizontal overflow — body is sole scroll container */
    overflow-x: hidden;
    /* Natural document scroll — no nested scroll containers */
  }

  /* Desktop: restore standard body typography */
  @media (min-width: 768px) {
    body {
      font-size: 16px;
      line-height: 1.65;
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     SCROLL-LOCK STATE — Applied via JS when modals/menus open
     Preserves scroll position and compensates for scrollbar width
     ═══════════════════════════════════════════════════════════════════════════ */
  body.scroll-locked {
    overflow: hidden !important;
    /* Scrollbar width compensation applied via JS --scrollbar-width */
    padding-right: var(--scrollbar-width, 0px);
  }

  /* Reduced motion: disable all animations and transitions */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* iOS Safari: fixed full-viewport underlay so overscroll can never reveal white */
  #ios-underlay {
    position: fixed;
    inset: 0;
    background-color: hsl(210 21% 5%);
    background-color: hsl(var(--site-black));
    z-index: 0;
    pointer-events: none;
  }

  /* App root element(s) - ensures full viewport coverage */
  #root,
  #__next {
    position: relative;
    z-index: 1;
    /* Dark background as baseline - prevents white flash on overscroll */
    background: hsl(var(--site-black));
    /* Simple min-height — no dynamic viewport units that cause iOS stretch */
    min-height: 100%;
    /* Safe area padding for notched devices */
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     TYPOGRAPHY PRIMITIVES — Token-driven (LOCKED)
     ═══════════════════════════════════════════════════════════════════════════ */

  /* H1 — Primary page heading. Locked globally. */
  h1 {
    font-size: var(--h1Size);
    font-weight: var(--h1Weight);
    line-height: var(--h1Line);
    letter-spacing: -0.015em;
    scroll-margin-top: calc(var(--header-height) + 24px);
  }

  @media (min-width: 768px) {
    :root {
      /* Desktop: 64px (h-16) */
      --header-h: 64px;
    }
  }

  /* H2 — Section titles. Fixed size, clearly subordinate. */
  h2 {
    font-size: var(--h2Size);
    font-weight: var(--h2Weight);
    line-height: var(--h2Line);
    letter-spacing: -0.01em;
    scroll-margin-top: calc(var(--header-height) + 24px);
  }

  /* H3-H6 — Subsection headings */
  h3 {
    font-size: var(--h3Size);
    font-weight: var(--h3Weight);
    line-height: var(--h3Line);
  }

  h4, h5, h6 {
    font-size: var(--smallSize);
    font-weight: 500;
    line-height: var(--smallLine);
  }

  /* Body text */
  p, li {
    font-size: var(--bodySize);
    font-weight: var(--bodyWeight);
    line-height: var(--bodyLine);
  }

  /* Small text */
  small, .text-small {
    font-size: var(--smallSize);
    font-weight: var(--smallWeight);
    line-height: var(--smallLine);
  }

  /* Paragraph rhythm — stackMedium between siblings */
  p + p {
    margin-top: var(--stack-standard);
  }
}

@layer components {
  /* ═════════════════════════════════════════════════════════════════════════════
     CANONICAL UTILITY CLASSES — DO NOT INVENT NEW ONES
     
     Use ONLY these classes for layout. No custom spacing.
     ═════════════════════════════════════════════════════════════════════════════ */

  /* Container — Responsive horizontal padding + max width */
  .container {
    padding-left: var(--gutter);
    padding-right: var(--gutter);
    margin-left: auto;
    margin-right: auto;
    max-width: var(--maxContentWidth);
  }

  /* Section shells — Dark and Light variants */
  .section--dark,
  .section-padding-dark {
    padding-top: var(--section-padding-y-dark);
    padding-bottom: var(--section-padding-y-dark);
  }
  
  .section--light,
  .section-padding,
  .section-padding-light {
    padding-top: var(--section-padding-y-light);
    padding-bottom: var(--section-padding-y-light);
  }
  
  .footer {
    padding-top: var(--footer-padding-top);
    padding-bottom: var(--footer-padding-bottom);
  }

  /* ═════════════════════════════════════════════════════════════════════════════
     STACK UTILITIES — Consistent vertical rhythm (LOCKED)
     
     Use .stack for default, or .stack--lg/md/sm/tight for specific sizes.
     Children automatically get the appropriate margin-top.
     ═════════════════════════════════════════════════════════════════════════════ */
  
  /* Default stack uses stackMedium */
  .stack > * + * { margin-top: var(--stack-standard); }
  .stack--lg > * + * { margin-top: var(--stack-loose); }
  .stack--md > * + * { margin-top: var(--stack-standard); }
  .stack--sm > * + * { margin-top: var(--stack-small); }
  .stack--tight > * + * { margin-top: var(--stack-tight); }
  
  /* Flex-gap variants (for flex containers) */
  .stack-tight { gap: var(--stack-tight); }
  .stack-small { gap: var(--stack-small); }
  .stack-standard { gap: var(--stack-standard); }
  .stack-loose { gap: var(--stack-loose); }
  
  /* Margin variants for non-flex contexts */
  .mt-stack-tight { margin-top: var(--stack-tight); }
  .mt-stack-small { margin-top: var(--stack-small); }
  .mt-stack-standard { margin-top: var(--stack-standard); }
  .mt-stack-loose { margin-top: var(--stack-loose); }
  .mb-stack-tight { margin-bottom: var(--stack-tight); }
  .mb-stack-small { margin-bottom: var(--stack-small); }
  .mb-stack-standard { margin-bottom: var(--stack-standard); }
  .mb-stack-loose { margin-bottom: var(--stack-loose); }

  /* ═════════════════════════════════════════════════════════════════════════════
     DIVIDER SPACING — LOCKED PATTERN
     ═════════════════════════════════════════════════════════════════════════════ */
  .dividerBlock,
  .divider-spacing {
    padding-top: var(--divider-spacing);
    padding-bottom: var(--divider-spacing);
  }

  /* ═════════════════════════════════════════════════════════════════════════════
     LEDE → LIST/STEPS BRIDGE — LOCKED PATTERN
     ═════════════════════════════════════════════════════════════════════════════ */
  .lede-to-list {
    margin-bottom: var(--lede-to-list-mobile);
  }
  
  @media (min-width: 1024px) {
    .lede-to-list {
      margin-bottom: var(--lede-to-list-desktop);
    }
  }
  
  /* Step/list container — locked spacing between items */
  .list-step-stack {
    display: flex;
    flex-direction: column;
    gap: var(--list-item-stack-mobile);
  }
  
  @media (min-width: 1024px) {
    .list-step-stack {
      gap: var(--list-item-stack-desktop);
    }
  }

  /* ═════════════════════════════════════════════════════════════════════════════
     TYPOGRAPHY PRIMITIVES — Token-driven classes (LOCKED)
     ═════════════════════════════════════════════════════════════════════════════ */
  .labelCaps {
    font-size: var(--labelCapsSize);
    font-weight: var(--labelCapsWeight);
    letter-spacing: var(--labelCapsTracking);
    line-height: var(--labelCapsLine);
    text-transform: uppercase;
  }
  
  .h1 { font-size: var(--h1Size); font-weight: var(--h1Weight); line-height: var(--h1Line); }
  .h2 { font-size: var(--h2Size); font-weight: var(--h2Weight); line-height: var(--h2Line); }
  .h3 { font-size: var(--h3Size); font-weight: var(--h3Weight); line-height: var(--h3Line); }
  .body { font-size: var(--bodySize); font-weight: var(--bodyWeight); line-height: var(--bodyLine); }
  .small { font-size: var(--smallSize); font-weight: var(--smallWeight); line-height: var(--smallLine); }

  /* ═════════════════════════════════════════════════════════════════════════════
     LINK STYLING — Premium restraint (LOCKED)
     ═════════════════════════════════════════════════════════════════════════════ */
  a {
    text-underline-offset: 3px;
    text-decoration-thickness: 1px;
  }
  
  a:hover { opacity: 0.85; }
  a:active { opacity: var(--tapOpacity); }

  /* Status chips - outline only, neutral */
  .status-chip {
    @apply inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium;
    @apply border border-border bg-transparent text-muted-foreground;
  }

  /* Hairline divider */
  .divider {
    @apply h-px bg-border/50;
  }

  /* Section gaps — Token-driven */
  .section-gap { margin-bottom: var(--stack-loose); }
  .subsection-gap { margin-bottom: var(--stack-standard); }
  .row-gap { margin-bottom: var(--stack-small); }

  /* Row density */
  .row-comfortable {
    @apply py-4; /* ~16px vertical = 56px total */
  }

  .row-compact {
    @apply py-2.5; /* ~10px vertical = 44px total */
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL INTERACTION STATE SYSTEM — LOCKED
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Focus ring - visible, 1px solid, 2px offset */
  .focus-ring {
    @apply focus-visible:outline-none;
  }

  .focus-ring:focus-visible {
    outline: 1px solid hsl(0 0% 9% / 0.4);
    outline-offset: 2px;
  }

  .dark .focus-ring:focus-visible,
  [data-dark="true"] .focus-ring:focus-visible {
    outline-color: hsl(0 0% 100% / 0.4);
  }

  /* Hover state - subtle opacity shift only */
  .hover-subtle {
    @apply transition-opacity duration-150 ease-out;
  }

  .hover-subtle:hover {
    opacity: 0.88;
  }

  /* Button hover - subtle brightness shift */
  .btn-hover {
    @apply transition-[filter,opacity] duration-150 ease-out;
  }

  .btn-hover:hover {
    filter: brightness(0.94);
  }

  .btn-hover:active {
    opacity: 0.85;
  }

  /* Link hover - underline emphasis */
  .link-hover {
    @apply transition-[text-decoration-color,opacity] duration-150 ease-out;
    text-decoration: underline;
    text-decoration-color: transparent;
    text-underline-offset: 2px;
  }

  .link-hover:hover {
    text-decoration-color: currentColor;
  }

  /* Link simple - opacity shift only (for navigation) */
  .link-simple {
    @apply transition-opacity duration-150 ease-out;
  }

  .link-simple:hover {
    opacity: 0.75;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     MOBILE NAVIGATION TYPOGRAPHY — LOCKED (STRIPE/MERCURY PATTERN)
     
     ╔═══════════════════════════════════════════════════════════════════════════╗
     ║  DO NOT TOUCH                                                             ║
     ║                                                                           ║
     ║  This mobile navigation structure, IA, typography tokens, and spacing    ║
     ║  are locked. Do not alter without explicit instruction.                   ║
     ╚═══════════════════════════════════════════════════════════════════════════╝
     ═══════════════════════════════════════════════════════════════════════════ */
  
  /* Mobile nav overlay — full-height, full-width, static feel */
  .mobile-nav-overlay {
    touch-action: none;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
  
  /* Primary navigation items — top stack (Services, How..., Contact) */
  .nav-primary-mobile {
    font-size: var(--nav-primary-size-mobile);
    font-weight: var(--nav-primary-weight-mobile);
    color: hsl(var(--nav-primary-color-mobile));
    transition: opacity 150ms ease-out;
    display: flex;
    align-items: center;
    min-height: 48px;
  }
  
  .nav-primary-mobile:hover,
  .nav-primary-mobile:focus-visible {
    opacity: 0.6;
  }
  
  .nav-primary-mobile:focus-visible {
    outline: 1px solid hsl(var(--foreground) / 0.15);
    outline-offset: 2px;
  }
  
  /* Action items — bottom stack (Sign in, Request Licensing Access) */
  .nav-action-mobile {
    font-size: var(--nav-action-size-mobile);
    font-weight: var(--nav-action-weight-mobile);
    color: hsl(var(--nav-action-color-mobile));
    transition: opacity 150ms ease-out;
    display: flex;
    align-items: center;
    min-height: 48px;
  }
  
  .nav-action-mobile:hover,
  .nav-action-mobile:focus-visible {
    opacity: 0.6;
  }
  
  .nav-action-mobile:focus-visible {
    outline: 1px solid hsl(var(--foreground) / 0.15);
    outline-offset: 2px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     DESKTOP NAVIGATION TYPOGRAPHY — LOCKED SYSTEM COMPONENT
     ═══════════════════════════════════════════════════════════════════════════ */
  
  .desktop-nav-sidebar {
    overscroll-behavior: contain;
  }
  
  .desktop-nav-primary {
    font-size: var(--desktop-nav-font-size);
    font-weight: var(--desktop-nav-font-weight);
    color: hsl(var(--desktop-nav-color));
    transition: color 120ms ease-out, font-weight 120ms ease-out;
    display: flex;
    align-items: center;
    min-height: 44px;
  }
  
  .desktop-nav-primary:hover,
  .desktop-nav-primary:focus-visible {
    color: hsl(var(--desktop-nav-color-hover));
    font-weight: var(--desktop-nav-font-weight-hover);
  }
  
  .desktop-nav-primary:focus-visible {
    outline: 1px solid hsl(var(--foreground) / 0.15);
    outline-offset: 2px;
  }
  
  .desktop-nav-secondary {
    font-size: var(--desktop-nav-font-size);
    font-weight: var(--desktop-nav-font-weight);
    color: hsl(var(--mobile-nav-secondary-color));
    padding-left: var(--mobile-nav-secondary-indent);
    transition: color 120ms ease-out, font-weight 120ms ease-out;
    display: flex;
    align-items: center;
    min-height: 44px;
  }
  
  .desktop-nav-secondary:hover,
  .desktop-nav-secondary:focus-visible {
    color: hsl(var(--desktop-nav-color-hover));
    font-weight: var(--desktop-nav-font-weight-hover);
  }
  
  .desktop-nav-secondary:focus-visible {
    outline: 1px solid hsl(var(--foreground) / 0.15);
    outline-offset: 2px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     FOOTER NAVIGATION TYPOGRAPHY — LOCKED SYSTEM COMPONENT
     ═══════════════════════════════════════════════════════════════════════════ */
  
  .footer-system {
    /* Token-driven — no inline overrides */
  }
  
  .footer-nav-grid {
    display: flex;
    flex-direction: column;
    gap: var(--footer-section-gap);
  }
  
  @media (min-width: 768px) {
    .footer-nav-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--footer-column-gap-tablet);
    }
  }
  
  @media (min-width: 1024px) {
    .footer-nav-grid {
      gap: var(--footer-column-gap-desktop);
    }
  }
  
  .footer-column {
    display: flex;
    flex-direction: column;
  }
  
  .footer-label {
    font-size: var(--footer-label-size);
    font-weight: var(--footer-label-weight);
    text-transform: uppercase;
    letter-spacing: var(--footer-label-tracking);
    color: hsl(var(--footer-label-color));
    margin-bottom: var(--footer-label-gap);
  }
  
  .footer-links {
    display: flex;
    flex-direction: column;
    gap: var(--footer-link-gap);
  }
  
  .footer-link {
    font-size: var(--footer-link-size);
    color: hsl(var(--footer-link-color));
    transition: opacity 150ms ease-out;
    display: block;
  }
  
  .footer-link:hover,
  .footer-link:focus-visible {
    opacity: 1;
    color: hsl(var(--footer-link-color-hover));
  }
  
  .footer-link:focus-visible {
    outline: 1px solid hsl(0 0% 100% / 0.20);
    outline-offset: 2px;
  }
  
  .footer-link-disabled {
    font-size: var(--footer-link-size);
    color: hsl(0 0% 100% / 0.50);
    display: block;
  }
  
  .footer-signature {
    margin-top: var(--footer-signature-gap);
  }
  
  .footer-wordmark {
    font-size: var(--footer-wordmark-size);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: hsl(0 0% 100%);
    display: block;
  }
  
  @media (min-width: 768px) {
    .footer-wordmark {
      font-size: var(--footer-wordmark-size-desktop);
    }
  }
  
  .footer-copyright {
    font-size: var(--footer-copyright-size);
    color: hsl(var(--footer-copyright-color));
    margin-top: 6px;
  }

  /* Disabled state - opacity only, no events */
  .state-disabled {
    @apply opacity-50 pointer-events-none cursor-not-allowed;
  }

  /* Input focus - border emphasis, no ring glow */
  .input-focus {
    @apply transition-[border-color] duration-150 ease-out;
  }

  .input-focus:hover:not(:disabled):not(:focus) {
    border-color: hsl(0 0% 70%);
  }

  .input-focus:focus {
    border-color: hsl(0 0% 50%);
    outline: none;
  }

  /* Label style */
  .label-muted {
    @apply text-xs font-medium text-muted-foreground;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   FORM PRIMITIVE HARD OVERRIDES — TRIBES INSTITUTIONAL STANDARD (LOCKED)

   Purpose: ensure NO default/consumer-grade form UI survives anywhere.
   Applies to: all forms across the site (public + auth + portal + admin).
   Excludes: non-form UI by scoping to <form> where possible.

   Non-negotiables:
   - No filled-square checkbox state
   - No pill inputs
   - No glows/shadows
   - Strong disabled contrast separation
   ═══════════════════════════════════════════════════════════════════════════════ */

@layer base {
  /* Inputs / textareas / selects — hard reset inside forms */
  :where(form) :where(
      input:not([type="checkbox"]):not([type="radio"]):not([type="range"]):not([type="file"]):not([type="color"]),
      textarea,
      select
    ) {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 6px;
    border-width: 1px;
    border-style: solid;
    border-color: hsl(0 0% 82%); /* ~#d0d0d0 */
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-size: 15px;
    line-height: 1.4;
    padding: 10px 12px; /* dense, contractual */
    min-height: 48px;
    box-shadow: none;
  }

  :where(form) textarea {
    min-height: 120px;
    padding-top: 12px;
    resize: none;
  }

  :where(form) :where(input, textarea)::placeholder {
    color: hsl(0 0% 55%);
  }

  :where(form) :where(input, textarea, select):disabled {
    background-color: hsl(0 0% 98%);
    border-color: hsl(0 0% 86%);
    color: hsl(0 0% 45%);
    cursor: not-allowed;
  }

  /* Focus: darker border, no glow, no layout shift */
  :where(form) :where(input, textarea, select):focus {
    outline: none;
    border-color: hsl(0 0% 7%); /* ~#111 */
  }

  /* Primary submit buttons (native) */
  :where(form) button[type="submit"],
  :where(form) button:not([type]) {
    border-radius: 6px;
    min-height: 48px;
  }

  :where(form) button[type="submit"] {
    width: 100%;
    background-color: hsl(var(--foreground));
    color: hsl(var(--background));
    font-size: 15px;
    font-weight: 500;
    box-shadow: none;
    transition: opacity 150ms ease-out;
  }

  :where(form) button[type="submit"]:hover {
    opacity: 0.9;
  }

  :where(form) button[type="submit"]:disabled {
    background-color: hsl(0 0% 64%);
    color: hsl(0 0% 100%);
    opacity: 1;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* Radix Checkbox (role="checkbox") — FORCIBLY NO FILL WHEN CHECKED */
  button[role="checkbox"][data-state] {
    background-color: hsl(var(--background)) !important;
    border: 1px solid hsl(0 0% 82%) !important;
    border-radius: 2px !important;
    box-shadow: none !important;
  }

  button[role="checkbox"][data-state="checked"] {
    background-color: hsl(var(--background)) !important;
    border-color: hsl(0 0% 32%) !important;
    color: hsl(0 0% 7%) !important;
  }

  button[role="checkbox"][data-state][data-disabled] {
    opacity: 0.45 !important;
  }

  /* Native checkbox fallback (if any exist) — EXCLUDES TribesCheckbox */
  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]) {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 2px;
    border: 1px solid hsl(0 0% 82%);
    background-color: hsl(var(--background));
    display: inline-grid;
    place-content: center;
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked {
    border-color: hsl(0 0% 32%);
    background-color: hsl(var(--background));
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked::after {
    content: "";
    width: 10px;
    height: 10px;
    transform: translateY(-0.5px) rotate(45deg);
    border-right: 2px solid hsl(0 0% 7%);
    border-bottom: 2px solid hsl(0 0% 7%);
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):disabled {
    opacity: 0.45;
  }
}


/* ═══════════════════════════════════════════════════════════════════════════════
   UX HARDENING — TRIBES INSTITUTIONAL STANDARD (LOCKED)
   
   Global interaction polish: tap targets, focus states, link feedback,
   headline orphan prevention. Applied to all marketing pages.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* C) TAP TARGETS — Minimum 44px touch area for mobile accessibility */
@layer base {
  /* Ensure all interactive elements have adequate tap area */
  a, button {
    min-height: 44px;
    display: inline-flex;
    align-items: center;
  }
  
  /* CRITICAL: Radix checkbox renders as button — prevent inflation */
  button[role="checkbox"] {
    min-height: unset;
    height: auto;
    align-items: flex-start;
  }
  
  /* Exception: inline text links within paragraphs */
  p a, li a, span a {
    min-height: auto;
    display: inline;
  }
  
  /* Navigation links get explicit padding for tap area */
  nav a {
    padding-top: 10px;
    padding-bottom: 10px;
  }
}

/* D) FOCUS STATES — Brand blue for focus/active only (LOCKED) */
@layer base {
  /* Mobile tap highlight discipline — no default flash */
  * { -webkit-tap-highlight-color: transparent; }

  /* Global focus-visible — uses brandFocus token */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    outline: var(--focusRingWidth) solid var(--brandFocus);
    outline-offset: var(--focusRingOffset);
  }
  
  /* Dark background focus states — white outline */
  [data-theme="dark"] a:focus-visible,
  [data-theme="dark"] button:focus-visible,
  [style*="background: #0B"] a:focus-visible,
  [style*="background: #0B"] button:focus-visible,
  [style*="backgroundColor"] a:focus-visible,
  footer a:focus-visible,
  footer button:focus-visible {
    outline-color: hsl(0 0% 100% / 0.50);
  }
  
  /* Remove default focus for mouse users */
  a:focus:not(:focus-visible),
  button:focus:not(:focus-visible) {
    outline: none;
  }
}

/* E) LINK FEEDBACK — Immediate interaction response */
@layer base {
  /* All links get pointer cursor */
  a {
    cursor: pointer;
  }
  
  /* Active/tap state for mobile */
  a:active,
  button:active {
    opacity: 0.85;
  }
}

/* F) HEADLINE ORPHAN PREVENTION — Controlled measure for premium line breaks */
@layer components {
  /* Marketing section headlines - prevent single-word orphans */
  .headline-measure {
    max-width: 90%;
  }
  
  @media (min-width: 768px) {
    .headline-measure {
      max-width: 640px;
    }
  }
}

/* G) FONT LOADING STABILITY — Prevent layout shift */
@layer base {
  /* System font stack with font-display swap for custom fonts if added */
  @font-face {
    font-family: 'SF Pro Text';
    src: local('SF Pro Text'), local('-apple-system'), local('BlinkMacSystemFont');
    font-display: swap;
  }
}

@layer utilities {
  /* ═══════════════════════════════════════════════════════════════════════════
     iOS SAFARI VIEWPORT UTILITIES — LOCKED
     
     These utilities ensure full viewport coverage on iOS Safari with
     dynamic viewport height support and safe-area handling.
     ═══════════════════════════════════════════════════════════════════════════ */
  
  /* Full dynamic viewport height - iOS Safari compatible */
  .min-h-dvh {
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* Safe area bottom padding for notched devices */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Content fade - opacity only, 150ms */
  .animate-content-fade {
    animation: contentFade 0.15s ease-out forwards;
  }

  @keyframes contentFade {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Button active state - brief opacity reduction, instant feedback */
  .btn-active {
    @apply active:opacity-85 active:transition-opacity active:duration-75;
  }

  /* Global focus visible for dark surfaces */
  [data-surface="dark"] *:focus-visible {
    outline: var(--focusRingWidth) solid hsl(0 0% 100% / 0.5) !important;
    outline-offset: var(--focusRingOffset);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     MOTION DISCIPLINE — Single easing/duration system (LOCKED)
     ═══════════════════════════════════════════════════════════════════════════ */
  
  /* Standard motion utility - uses locked tokens */
  .motion {
    transition-duration: var(--motionFast);
    transition-timing-function: var(--motionEase);
  }
  
  /* Reduced motion compliance */
  @media (prefers-reduced-motion: reduce) {
    .motion { transition: none !important; }
  }

  /* Global transition utility - locked duration */
  .transition-interaction {
    @apply transition-all duration-150 ease-out;
  }
}
